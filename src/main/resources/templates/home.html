<!doctype html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/layouts/layout}">
<head>
    <style>
        .task-text {
            transition: all 0.2s ease-in-out; 
        }
        input[type="checkbox"]:checked + label .task-text {
            text-decoration: line-through;
            color: gray;
        }
    </style>
</head>
<body>
<main layout:fragment="content">
    <div class="container col-xl-10 col-xxl-8 px-1 py-5">
        <div class="row align-items-center g-lg-5 py-5">
            <!--ì˜¤ëŠ˜ì˜í• ì¼-->
            <div class="col-md-10 mx-auto col-lg-5">
                <p class="col-lg-10 fs-4">ì˜¤ëŠ˜ì˜ í•  ì¼</p>
                <form id="taskForm" class="p-4 p-md-5 border rounded-3 bg-light">
                    <small class="text-muted">í•  ì¼ì„ ì €ì¥í•˜ê³  ì„±ì·¨ê°ì„ ëŠê»´ë³´ì„¸ìš”! ë¡œê·¸ì¸í•˜ë©´ ì–¸ì œë“  í™•ì¸í•  ìˆ˜ ìˆì–´ìš”. ğŸ˜†âœ¨</small>
                    <div class="d-grid gap-2 d-sm-flex justify-content-sm-center mt-3">
                        <input type="text" id="taskInput" class="form-control" placeholder="í•  ì¼ì„ ì…ë ¥í•˜ì„¸ìš”">
                        <button type="submit" class="btn btn-outline-secondary" style="white-space: nowrap;">ë“±ë¡</button>
                    </div>
                    <hr class="my-3">
                    <div id="taskList"></div>
                    <button id="deleteSelected" class="w-100 btn btn-primary mt-3" type="submit">ì„ íƒì‚­ì œ</button>
                </form>
            </div>

            <!--í•œì¤„ì¼ê¸°-->
            <div class="col-md-10 mx-auto col-lg-5">
                <p class="col-lg-10 fs-4">ì˜¤ëŠ˜ í•˜ë£¨ëŠ” ì–´ë• ë‚˜ìš”?</p>
                <!--í•œì¤„ì¼ê¸° ì‘ì„± í¼-->
                <form th:if="${todayDiary == null}" action="/diary/home-save" method="post" class="p-4 p-md-5 border rounded-3 bg-light">
                    <div class="col-sm-12 mb-3">
                        <label for="diaryWriter" class="form-label">ì‘ì„±ì</label>
                        <input type="text" id="diaryWriter" name="diaryWriter" class="form-control" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="col-sm-12 mb-3">
                        <label for="diaryContents" class="form-label">ë‚´ìš©</label>
                        <textarea id="diaryContents" name="diaryContents" class="form-control" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”" rows="2"></textarea>
                    </div>
                    <div class="col-sm-12 mb-4">
                        <label for="moodToday" class="form-label">ì˜¤ëŠ˜ì˜ ê°ì •</label>
                        <select id="moodToday" name="moodToday" class="form-select" required>
                            <option value="" disabled selected>ì„ íƒí•˜ê¸°</option>
                            <option value="happy">ğŸ˜Š ê¸°ì¨</option>
                            <option value="sad">ğŸ˜¢ ìŠ¬í””</option>
                            <option value="angry">ğŸ˜¡ í™”ë‚¨</option>
                            <option value="excited">ğŸ¤© ì‹ ë‚¨</option>
                            <option value="tired">ğŸ˜´ í”¼ê³¤</option>
                            <option value="calm">ğŸ˜Œ ì°¨ë¶„</option>
                            <option value="soso">ğŸ™‚ ê·¸ëƒ¥</option>
                        </select>
                    </div>
                    <button class="w-100 btn btn-primary" type="submit">ì¼ê¸° ë“±ë¡</button>
                    <hr class="my-3">
                    <small class="text-muted">ë¡œê·¸ì¸í•´ì„œ í•œ ì¤„ ì¼ê¸°ë¥¼ ë§¤ì¼ ê¸°ë¡í•˜ê³  ë‚˜ë§Œì˜ ê¸°ë¡ì •ì›ì„ ê°€ê¿”ë³´ì„¸ìš”! ğŸŒ±</small>
                </form>

                <!--ì‘ì„±ëœ í•œ ì¤„ ì¼ê¸° í‘œì‹œ-->
                <div th:if="${todayDiary != null}" class="p-4 p-md-5 border rounded-3 mt-4 bg-light">
                    <div class="d-flex align-items-center gap-1 mb-3">
                        <label class="form-label fw-bold mb-0" style="min-width: 50px;">ì‘ì„±ì</label>
                        <input th:value="${todayDiary.diaryWriter}" type="text" name="diaryWriter" class="form-control" readonly>
                    </div>
                    <div class="d-flex align-items-center gap-1 mb-3">
                        <label class="form-label fw-bold mb-0" style="min-width: 50px;">ë‚´ìš©</label>
                        <textarea th:text="${todayDiary.diaryContents}" name="diaryContents" class="form-control" readonly rows="2"></textarea>
                    </div>
                    <div class="d-flex align-items-center gap-1 mb-3">
                        <label class="form-label fw-bold mb-0" style="min-width: 80px;">ì˜¤ëŠ˜ì˜ ê°ì •</label>
                        <input th:value="${todayDiary.moodToday}" type="text" name="moodToday" class="form-control" readonly>
                    </div>
                    <div class="d-flex align-items-center gap-1 mb-4">
                        <label for="createdAt" class="form-label fw-bold mb-0" style="min-width: 50px;">ì‘ì„±ì¼</label>
                        <input th:value="${todayDiary.createdAt}" type="text" id="createdAt" name="createdAt" class="form-control" readonly>
                    </div>
                    <div class="d-flex justify-content-around">
                        <button onclick="checkLogin('edit')" class="btn btn-lg btn-primary" type="submit">ìˆ˜ì •í•˜ê¸°</button>
                        <button onclick="checkLogin('list')" class="btn btn-lg btn-primary" type="submit">ëª©ë¡ë³´ê¸°</button>
                    </div>
                    <hr class="my-3">
                    <small class="text-muted">ë¡œê·¸ì¸ì„ í•˜ë©´ í•œ ì¤„ ì¼ê¸°ë¥¼ ìˆ˜ì •í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆì–´ìš”.</small>
                </div>
            </div>
        </div>
    </div>
    <script>
        // ì˜¤ëŠ˜ì˜í• ì¼
        document.addEventListener("DOMContentLoaded", function() {
            const taskForm = document.getElementById("taskForm");
            const taskInput = document.getElementById("taskInput");
            const taskList = document.getElementById("taskList");
            const deleteSelected = document.getElementById("deleteSelected");

            taskForm.addEventListener("submit", function (event) {
                event.preventDefault(); // ê¸°ë³¸ ì œì¶œ ë§‰ê¸°

                const taskText = taskInput.value.trim(); // ê³µë°± ì œê±°
                if(taskText === "") return; // ë¹ˆì¹¸ì…ë ¥ ë°©ì§€

                const taskId = "task-" + Date.now; // ìœ ë‹ˆí¬í•œ id ìƒì„±

                // í• ì¼ í•­ëª© ìƒì„±
                const taskItem = document.createElement("div");
                taskItem.classList.add("form-check", "mb-2");
                taskItem.innerHTML = `
                    <input class="form-check-input" type="checkbox" id="${taskId}">
                    <label class="form-check-label" for="${taskId}">
                        <span class="task-text">${taskText}</span>
                    </label>
                `;

                taskList.appendChild(taskItem); // ëª©ë¡ì— ì¶”ê°€
                taskInput.value = ""; // ì…ë ¥ì°½ ì´ˆê¸°í™”
            });

            // ì„ íƒì‚­ì œ ë²„íŠ¼ í´ë¦­ ì‹œ ì²´í¬ëœ í•­ëª© ì œê±°
            deleteSelected.addEventListener("click", function(event) {
                event.preventDefault();
                document.querySelectorAll("#taskList .form-check-input:checked").forEach((checkbox) => {
                    checkbox.closest(".form-check").remove();
                });
            });
        });

    function checkLogin(action) {
        // ë¡œê·¸ì¸ ì—¬ë¶€ í™•ì¸
        const isLoggedIn = false; // ë‚˜ì¤‘ì— ìˆ˜ì •í• ê²ƒ

        if(!isLoggedIn) {
            alert("ë¡œê·¸ì¸ í›„ì— ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!");
        } else {
            // ë¡œê·¸ì¸ë˜ì–´ìˆë‹¤ë©´ ì›í•˜ëŠ” ë¡œì§ ìˆ˜í–‰
            if(action === 'edit') {
                // ìˆ˜ì •í•˜ê¸° ë™ì‘
            } else if(action === 'list') {
                // ëª©ë¡ë³´ê¸° ë™ì‘
            }
        }
    }
    </script>
</main>
</body>
</html>